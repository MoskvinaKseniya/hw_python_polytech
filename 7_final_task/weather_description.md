# Описание работы программы: "Информация о погоде"
## 0. Инструкция для запуска

Минимальная версия Python, необходимая для запуска приложения, — 3.10. Рекомендуется использовать Python 3.13.0 или выше.
Проверить установленную версию Python: 
```example
python --version
```
Используемые библиотеки:
   * datetime — встроенный модуль Python для работы с датой и временем
   * requests==2.32.3 — для выполнения запросов к API
   * sqlite3 - встроенный модуль Python для хранения истории запросов

Файл requirements.txt содержит список библиотек, которые необходимы для корректной работы проекта.
Чтобы установить перечисленные зависимости, выполните следующую команду в терминале:
```example
pip install -r requirements.txt
```


Для работы с сервисом [API openweathermap](https://openweathermap.org/current) необходимо прописать свой ключ в переменную API_key
в файле weather_functions.py

Запуск приложения: точка входа в программу — файл main.py. Запустите приложение следующей командой:
```example
python main.py
```


## 1. Интерфейс программы
Интерфейс программы - консольное меню с выбором действия из списка.
Доступные команды:

1) определить погоду по названию города
2) определить погоду для текущего местоположения
3) посмотреть историю запросов
4) завершить работу

Ожидаемое поведение при выборе команд:

1) запрашивается название города
2) выводит текущее местоположение и информацию о погоде
3) просит ввести число n, показывает последние n запросов из истории
4) чистит историю запросов, прекращает запрашивать новую команду

Программа повторяет цикл (выбор действия - получение команды от пользователя - ответ программы и запись в историю), пока пользователь не выберет команду "завершить работу".


## 2. Получение информации о погоде по конкретному городу

Для получения информации о погоде по конкретному городу используем встроенный запрос API по названию города из [API openweathermap](https://openweathermap.org/current).

URL API: https://api.openweathermap.org/data/2.5/weather?g={city_name}&appid={API_key}&units=metric&lang=ru

Параметры запроса:

* q: название города
* appid: API-ключ задан по умолчанию
* units: единицы измерения по умолчанию температура в градусах Цельсия (metric)
* lang: язык ответа сервиса задан по умолчанию русский (ru)


## 3. Получение информации о погоде для текущего месторасположения

Для определения текущего местоположения используем еще один популярный сервис [IP Geolocation API](https://ip-api.com/), с помощью которого можно получить информацию о местоположении по IP-адресу.
API автоматически использует IP-адрес устройства, с которого сделан запрос.

URL API: http://ip-api.com/json/?lang=ru

Из ответа API извлекается поле "city" и дальше выполняется запрос из пункта 2.

## 4. Хранение истории запросов

Для хранения истории запросов будет использоваться SQLite. Таблица history находится в файле weather_app_history.
При новом запросе добавляется запись в конец списка. Если для нового запроса вернулся ответ с ошибкой, новая запись в историю не добавляется.
Если пользователь запросил список истории из n элементов, то выводятся последние n элементов списка.

## 5. Обработка ошибок
Возможные ошибки и их обработка:
* невалидный ввод пользователя: если пользователь вводит некорректные данные, программа выдает сообщение об ошибке и предлагает повторить ввод.
* ошибки API: если сервис возвращают ошибку, программа выводит сообщение об ошибке, используя описание из ответа API.
